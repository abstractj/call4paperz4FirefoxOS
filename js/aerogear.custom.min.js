/*! AeroGear JavaScript Library - v1.3.0 - 2013-11-24
* https://github.com/aerogear/aerogear-js
* JBoss, Home of Professional Open Source
* Copyright Red Hat, Inc., and individual contributors
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
* http://www.apache.org/licenses/LICENSE-2.0
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/
(function(e,t){this.AeroGear={},AeroGear.Core=function(){if(this instanceof AeroGear.Core)throw"Invalid instantiation of base class AeroGear.Core";this.add=function(e){var t,r,a=this[this.collectionName]||{};if(this[this.collectionName]=a,!e)return this;if("string"==typeof e)a[e]=AeroGear[this.lib].adapters[this.type](e,this.config);else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)r=e[t],"string"==typeof r?a[r]=AeroGear[this.lib].adapters[this.type](r,this.config):r.name&&(r.settings=AeroGear.extend(r.settings||{},this.config),r.settings.recordId=r.settings.recordId||r.recordId,a[r.name]=AeroGear[this.lib].adapters[r.type||this.type](r.name,r.settings));else{if(!e.name)return this;e.settings=AeroGear.extend(e.settings||{},this.config),e.settings.recordId=e.settings.recordId||e.recordId,a[e.name]=AeroGear[this.lib].adapters[e.type||this.type](e.name,e.settings)}return this[this.collectionName]=a,this},this.remove=function(e){var t,r,a=this[this.collectionName]||{};if("string"==typeof e)delete a[e];else if(AeroGear.isArray(e))for(t=0;e.length>t;t++)r=e[t],"string"==typeof r?delete a[r]:delete a[r.name];else e&&delete a[e.name];return this[this.collectionName]=a,this}},AeroGear.isArray=function(e){return"[object Array]"==={}.toString.call(e)},AeroGear.extend=function(e,t){var r;for(r in t)e[r]=t[r];return e},function(){function e(e,t,r){var a=t&&r||0,i=0;for(t=t||[],e.toLowerCase().replace(/[0-9a-f]{2}/g,function(e){16>i&&(t[a+i++]=g[e])});16>i;)t[a+i++]=0;return t}function t(e,t){var r=t||0,a=h;return a[e[r++]]+a[e[r++]]+a[e[r++]]+a[e[r++]]+"-"+a[e[r++]]+a[e[r++]]+"-"+a[e[r++]]+a[e[r++]]+"-"+a[e[r++]]+a[e[r++]]+"-"+a[e[r++]]+a[e[r++]]+a[e[r++]]+a[e[r++]]+a[e[r++]]+a[e[r++]]}function r(e,r,a){var i=r&&a||0,n=r||[];e=e||{};var s=null!=e.clockseq?e.clockseq:v,o=null!=e.msecs?e.msecs:(new Date).getTime(),c=null!=e.nsecs?e.nsecs:G+1,u=o-D+(c-G)/1e4;if(0>u&&null==e.clockseq&&(s=16383&s+1),(0>u||o>D)&&null==e.nsecs&&(c=0),c>=1e4)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");D=o,G=c,v=s,o+=122192928e5;var d=(1e4*(268435455&o)+c)%4294967296;n[i++]=255&d>>>24,n[i++]=255&d>>>16,n[i++]=255&d>>>8,n[i++]=255&d;var f=268435455&1e4*(o/4294967296);n[i++]=255&f>>>8,n[i++]=255&f,n[i++]=16|15&f>>>24,n[i++]=255&f>>>16,n[i++]=128|s>>>8,n[i++]=255&s;for(var p=e.node||A,l=0;6>l;l++)n[i+l]=p[l];return r?r:t(n)}function a(e,r,a){var i=r&&a||0;"string"==typeof e&&(r="binary"==e?new l(16):null,e=null),e=e||{};var n=e.random||(e.rng||p)();if(n[6]=64|15&n[6],n[8]=128|63&n[8],r)for(var s=0;16>s;s++)r[i+s]=n[s];return r||t(n)}var i,n,s,o=this,c=Array(16);if(i=function(){for(var e,e,t=c,r=0,r=0;16>r;r++)0==(3&r)&&(e=4294967296*Math.random()),t[r]=255&e>>>((3&r)<<3);return t},o.crypto&&crypto.getRandomValues){var u=new Uint32Array(4);s=function(){crypto.getRandomValues(u);for(var e=0;16>e;e++)c[e]=255&u[e>>2]>>>8*(3&e);return c}}try{var d=require("crypto").randomBytes;n=d&&function(){return d(16)}}catch(f){}for(var p=n||s||i,l="function"==typeof Buffer?Buffer:Array,h=[],g={},y=0;256>y;y++)h[y]=(y+256).toString(16).substr(1),g[h[y]]=y;var m=p(),A=[1|m[0],m[1],m[2],m[3],m[4],m[5]],v=16383&(m[6]<<8|m[7]),D=0,G=0,I=a;if(I.v1=r,I.v4=a,I.parse=e,I.unparse=t,I.BufferClass=l,I.mathRNG=i,I.nodeRNG=n,I.whatwgRNG=s,"undefined"!=typeof module)module.exports=I;else{var b=o.uuid;I.noConflict=function(){return o.uuid=b,I},o.uuid=I}}(),AeroGear.Pipeline=function(e){return this instanceof AeroGear.Pipeline?(AeroGear.Core.call(this),this.config=e||{},this.lib="Pipeline",this.type=e?e.type||"Rest":"Rest",this.collectionName="pipes",this.add(e),t):new AeroGear.Pipeline(e)},AeroGear.Pipeline.prototype=AeroGear.Core,AeroGear.Pipeline.constructor=AeroGear.Pipeline,AeroGear.Pipeline.adapters={},AeroGear.DataManager=function(e){return this instanceof AeroGear.DataManager?(this.add=function(e){e=e||{};var t,r;e=AeroGear.isArray(e)?e:[e],e=e.map(function(e){if("string"!=typeof e&&(r=e.type||"Memory",!(r in AeroGear.DataManager.validAdapters)))for(t=0;AeroGear.DataManager.prefered.length>t;t++)if(AeroGear.DataManager.prefered[t]in AeroGear.DataManager.validAdapters)return("IndexedDB"===r||"WebSQL"===r)&&(e.settings=AeroGear.extend(e.settings||{},{async:!0})),e.type=AeroGear.DataManager.prefered[t],e;return e},this),AeroGear.Core.call(this),this.add(e),this.add=this._add},this._add=this.add,this.remove=function(e){AeroGear.Core.call(this),this.remove(e),this.remove=this._remove},this._remove=this.remove,this.lib="DataManager",this.type=e?e.type||"Memory":"Memory",this.collectionName="stores",this.add(e),t):new AeroGear.DataManager(e)},AeroGear.DataManager.prototype=AeroGear.Core,AeroGear.DataManager.constructor=AeroGear.DataManager,AeroGear.DataManager.validAdapters={},AeroGear.DataManager.prefered=["IndexedDB","WebSQL","SessionLocal","Memory"],AeroGear.DataManager.validateAdapter=function(e,t){t.isValid()&&(AeroGear.DataManager.validAdapters[e]=t)},AeroGear.DataManager.adapters={},AeroGear.DataManager.STATUS_NEW=1,AeroGear.DataManager.STATUS_MODIFIED=2,AeroGear.DataManager.STATUS_REMOVED=0,AeroGear.DataManager.adapters.base=function(t,r){if(this instanceof AeroGear.DataManager.adapters.base)throw"Invalid instantiation of base class AeroGear.DataManager.adapters.base";r=r||{};var a=null,i=r.recordId?r.recordId:"id",n=r.crypto||{},s=n.options||{};this.getData=function(){return a},this.setData=function(e){a=e},this.getRecordId=function(){return i},this.always=function(e,t,r){r&&r.call(this,e,t)},this.encrypt=function(r){var a;return n.agcrypto?(s.data=sjcl.codec.utf8String.toBits(JSON.stringify(r)),a={id:r[i],data:n.agcrypto.encrypt(s)},e.localStorage.setItem("ag-"+t+"-IV",JSON.stringify({id:n.agcrypto.getIV()})),a):r},this.decrypt=function(r,a){var i,o;return n.agcrypto?(o=JSON.parse(e.localStorage.getItem("ag-"+t+"-IV"))||{},s.IV=o.id,r=AeroGear.isArray(r)?r:[r],i=r.map(function(e){return s.data=e.data,JSON.parse(sjcl.codec.utf8String.fromBits(n.agcrypto.decrypt(s)))}),a?i[0]:i):r}},AeroGear.Pipeline.adapters.Rest=function(e,r){if(!(this instanceof AeroGear.Pipeline.adapters.Rest))return new AeroGear.Pipeline.adapters.Rest(e,r);r=r||{};var a=r.endpoint||e,i={url:r.baseURL?r.baseURL+a:a,contentType:r.contentType||"application/json",dataType:r.dataType||"json",xhrFields:r.xhrFields},n=r.recordId||"id",s=r.authenticator||null,o=r.pageConfig,c=r.timeout?1e3*r.timeout:6e4;this.getAjaxSettings=function(){return i},this.getAuthenticator=function(){return s},this.getRecordId=function(){return n},this.getTimeout=function(){return c},this.getPageConfig=function(){return o},this.updatePageConfig=function(e,t){t?(o={},o.metadataLocation=e.metadataLocation?e.metadataLocation:"webLinking",o.previousIdentifier=e.previousIdentifier?e.previousIdentifier:"previous",o.nextIdentifier=e.nextIdentifier?e.nextIdentifier:"next",o.parameterProvider=e.parameterProvider?e.parameterProvider:null):jQuery.extend(o,e)},o&&this.updatePageConfig(o,!0),this.webLinkingPageParser=function(e){var r,a,i,n,s,c={};a=e.getResponseHeader("Link").split(",");for(var u in a){r=a[u].trim().split(";");for(var d in r)i=r[d].trim(),0===i.indexOf("<")&&i.lastIndexOf(">")===r[d].length-1?n=i.substr(1,i.length-2).split("?")[1]:0===i.indexOf("rel=")&&(i.indexOf(o.previousIdentifier)>=0?s=o.previousIdentifier:i.indexOf(o.nextIdentifier)>=0&&(s=o.nextIdentifier));s&&(c[s]=n,s=t)}return c},this.headerPageParser=function(e){var t=e.getResponseHeader(o.previousIdentifier),r=e.getResponseHeader(o.nextIdentifier),a={},i={};return o.parameterProvider?(a=o.parameterProvider(e),i[o.previousIdentifier]=a[o.previousIdentifier],i[o.nextIdentifier]=a[o.nextIdentifier]):(i[o.previousIdentifier]=t?t.split("?")[1]:null,i[o.nextIdentifier]=r?r.split("?")[1]:null),i},this.bodyPageParser=function(e){var t={},r={};return o.parameterProvider?(r=o.parameterProvider(e),t[o.previousIdentifier]=r[o.previousIdentifier],t[o.nextIdentifier]=r[o.nextIdentifier]):(t[o.previousIdentifier]=e[o.previousIdentifier],t[o.nextIdentifier]=e[o.nextIdentifier]),t},this.formatJSONError=function(e){if("json"===this.getAjaxSettings().dataType)try{e.responseJSON=JSON.parse(e.responseText)}catch(t){}return e}},AeroGear.Pipeline.adapters.Rest.prototype.read=function(e){var r,a,i,n,s=this,o=this.getRecordId(),c=this.getAjaxSettings(),u=this.getPageConfig();if(e=e?e:{},e.query=e.query?e.query:{},r=e[o]?c.url+"/"+e[o]:c.url,u&&e.paging!==!1){e.paging||(e.paging={offset:e.offsetValue||0,limit:e.limitValue||10}),e.query=e.query||{};for(var d in e.paging)e.query[d]=e.paging[d]}return a=function(r,a,i){var n;u&&e.paging!==!1&&(n=s[u.metadataLocation+"PageParser"]("body"===u.metadataLocation?r:i),["previous","next"].forEach(function(a){r[a]=function(e,r,a){return function(i){return a.paging=!0,a.offsetValue=a.limitValue=t,a.query=r,a.success=i&&i.success?i.success:a.success,a.error=i&&i.error?i.error:a.error,e.read(a)}}(s,n[u[a+"Identifier"]],e)})),e.success&&e.success.apply(this,arguments)},i=function(t){t=s.formatJSONError(t),e.error&&e.error.apply(this,arguments)},n={type:"GET",data:e.query,success:a,error:i,url:r,statusCode:e.statusCode,complete:e.complete,headers:e.headers,timeout:this.getTimeout()},e.jsonp&&(n.dataType="jsonp",n.jsonp=e.jsonp.callback?e.jsonp.callback:"callback",e.jsonp.customCallback&&(n.jsonpCallback=e.jsonp.customCallback)),jQuery.ajax(jQuery.extend({},this.getAjaxSettings(),n))},AeroGear.Pipeline.adapters.Rest.prototype.save=function(t,r){var a,i,n,s,o,c,u,d=this,f=this.getRecordId(),p=this.getAjaxSettings();if(t=t||{},r=r||{},a=t[f]?"PUT":"POST",i=t[f]?p.url+"/"+t[f]:p.url,n=function(){r.success&&r.success.apply(this,arguments)},s=function(e){e=d.formatJSONError(e),r.error&&r.error.apply(this,arguments)},o=jQuery.extend({},p,{data:t,type:a,url:i,success:n,error:s,statusCode:r.statusCode,complete:r.complete,headers:r.headers,timeout:this.getTimeout()}),"FormData"in e){c=new FormData;for(u in t)c.append(u,t[u]),(t[u]instanceof File||t[u]instanceof Blob)&&(o.contentType=!1,o.processData=!1);o.contentType===!1&&(o.data=c),o.xhr=function(){var e=jQuery.ajaxSettings.xhr();return e.upload&&e.upload.addEventListener("progress",function(){r.progress&&r.progress.apply(this,arguments)},!1),e}}return"application/json"===o.contentType&&o.data&&"string"!=typeof o.data&&(o.data=JSON.stringify(o.data)),jQuery.ajax(jQuery.extend({},this.getAjaxSettings(),o))},AeroGear.Pipeline.adapters.Rest.prototype.remove=function(e,t){var r,a,i,n,s,o=this,c=this.getRecordId(),u=this.getAjaxSettings(),d="";return"string"==typeof e||"number"==typeof e?r=e:e&&e[c]?r=e[c]:e&&!t&&(t=e),t=t||{},d=r?"/"+r:"",a=u.url+d,i=function(){t.success&&t.success.apply(this,arguments)},n=function(e){e=o.formatJSONError(e),t.error&&t.error.apply(this,arguments)},s={type:"DELETE",url:a,success:i,error:n,statusCode:t.statusCode,complete:t.complete,headers:t.headers,timeout:this.getTimeout()},jQuery.ajax(jQuery.extend({},u,s))},AeroGear.DataManager.adapters.Memory=function(e,r){return this instanceof AeroGear.DataManager.adapters.Memory?(AeroGear.DataManager.adapters.base.apply(this,arguments),this.emptyData=function(){this.setData(null)},this.addDataRecord=function(e){this.getData().push(e)},this.updateDataRecord=function(e,t){this.getData()[e]=t},this.removeDataRecord=function(e){this.getData().splice(e,1)},this.always=function(e,t,r){r&&r.call(this,e,t)},this.getAsync=function(){return r&&r.async?!0:!1},this.open=function(e){return jQuery.Deferred().resolve(t,"success",e&&e.success)},this.close=function(){},this.traverseObjects=function(e,t,r){for(;"object"==typeof t&&r;)e=Object.keys(t)[0],t=t[e],r=r[e];return t===r?!0:!1},t):new AeroGear.DataManager.adapters.Memory(e,r)},AeroGear.DataManager.adapters.Memory.isValid=function(){return!0},AeroGear.DataManager.adapters.Memory.prototype.read=function(e,r){var a,i={},n=jQuery.Deferred(),s=this.getAsync();return i[this.getRecordId()]=e,e?s?this.filter(i).then(function(e){a=e}):a=this.filter(i):a=this.getData(),s?(n.always(this.always),n.resolve(a,"success",r?r.success:t)):a},AeroGear.DataManager.adapters.Memory.prototype.save=function(e,r){var a=!1,i=jQuery.Deferred(),n=this.getAsync();if(e=AeroGear.isArray(e)?e:[e],r&&r.reset)this.setData(e);else if(this.getData())for(var s=0;e.length>s;s++){for(var o in this.getData())if(this.getData()[o][this.getRecordId()]===e[s][this.getRecordId()]){this.updateDataRecord(o,e[s]),a=!0;break}a||this.addDataRecord(e[s]),a=!1}else this.setData(e);return n?(i.always(this.always),i.resolve(this.getData(),"success",r?r.success:t)):this.getData()},AeroGear.DataManager.adapters.Memory.prototype.remove=function(e,r){var a,i,n,s=jQuery.Deferred(),o=this.getAsync();if(s.always(this.always),!e)return this.emptyData(),o?s.resolve(this.getData(),"success",r?r.success:t):this.getData();e=AeroGear.isArray(e)?e:[e];for(var c=0;e.length>c;c++){if("string"==typeof e[c]||"number"==typeof e[c])a=e[c];else{if(!e)continue;a=e[c][this.getRecordId()]}i=this.getData(!0);for(n in i)i[n][this.getRecordId()]===a&&this.removeDataRecord(n)}return o?s.resolve(this.getData(),"success",r?r.success:t):this.getData()},AeroGear.DataManager.adapters.Memory.prototype.filter=function(e,r,a){var i,n,s,o,c,u=this,d=jQuery.Deferred(),f=this.getAsync();return d.always(this.always),e?(i=this.getData().filter(function(t){var a,i,d=r?!1:!0,f=Object.keys(e);for(n=0;f.length>n;n++){if(e[f[n]].data)for(a=e[f[n]],i=a.matchAny?!1:!0,s=0;a.data.length>s;s++)if(AeroGear.isArray(t[f[n]]))if(t[f[n]].length){if(0===jQuery(t[f]).not(a.data).length&&0===jQuery(a.data).not(t[f]).length){i=!0;break}for(o=0;t[f[n]].length>o;o++){if(a.matchAny&&a.data[s]===t[f[n]][o]){if(i=!0,r)break;for(c=0;t[f[n]].length>c;c++)if(!r&&a.data[s]!==t[f[n]][c]){i=!1;break}}if(!a.matchAny&&a.data[s]!==t[f[n]][o]){i=!1;break}}}else i=!1;else if("object"==typeof a.data[s]){if(a.matchAny&&u.traverseObjects(f[n],a.data[s],t[f[n]])){i=!0;break}if(!a.matchAny&&!u.traverseObjects(f[n],a.data[s],t[f[n]])){i=!1;break}}else{if(a.matchAny&&a.data[s]===t[f[n]]){i=!0;break}if(!a.matchAny&&a.data[s]!==t[f[n]]){i=!1;break}}else if(AeroGear.isArray(t[f[n]]))if(i=r?!1:!0,t[f[n]].length)for(s=0;t[f[n]].length>s;s++){if(r&&e[f[n]]===t[f[n]][s]){i=!0;break}if(!r&&e[f[n]]!==t[f[n]][s]){i=!1;break}}else i=!1;else i="object"==typeof e[f[n]]?u.traverseObjects(f[n],e[f[n]],t[f[n]]):e[f[n]]===t[f[n]]?!0:!1;if(r&&i){d=!0;break}if(!r&&!i){d=!1;break}}return d}),f?d.resolve(i,"success",a?a.success:t):i):(i=this.getData()||[],f?d.resolve(i,"success",a?a.success:t):i)},AeroGear.DataManager.validateAdapter("Memory",AeroGear.DataManager.adapters.Memory)})(this);
//@ sourceMappingURL=aerogear.custom.map